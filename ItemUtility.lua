ItemModule = {}

ItemModule['earlyGameItem'] = {
	 "item_tango_single",
	 "item_clarity",
	 "item_faerie_fire",
	 "item_tango",  
	 "item_flask", 
	 "item_infused_raindrop",
	 "item_quelling_blade", 
	 "item_stout_shield", 
	 "item_magic_wand",
	 "item_bottle",  
	 "item_soul_ring",  
	 "item_ring_of_aquila", 
	 "item_dust",
	 "item_ward_observer",
	 "item_tpscroll"
}

ItemModule['earlyBoots'] = {  
	"item_phase_boots", 
	"item_power_treads", 
	"item_tranquil_boots", 
	"item_arcane_boots"  
}

ItemModule["basic_items"] = {    
	"item_aegis";
	"item_courier";
	"item_boots_of_elves";
	"item_belt_of_strength";
	"item_blade_of_alacrity";
	"item_blades_of_attack";
	"item_blight_stone";
	"item_blink";
	"item_boots";
	"item_bottle";
	"item_broadsword";
	"item_chainmail";
	"item_cheese";
	"item_circlet";
	"item_clarity";
	"item_claymore";
	"item_cloak";
	"item_demon_edge";
	"item_dust";
	"item_eagle";
	"item_enchanted_mango";
	"item_energy_booster";
	"item_faerie_fire";
	"item_flying_courier";
	"item_gauntlets";
	"item_gem";
	"item_ghost";
	"item_gloves";
	"item_flask";
	"item_helm_of_iron_will";
	"item_hyperstone";
	"item_infused_raindrop";
	"item_branches";
	"item_javelin";
	"item_magic_stick";
	"item_mantle";
	"item_mithril_hammer";
	"item_lifesteal";
	"item_mystic_staff";
	"item_ward_observer";
	"item_ogre_axe";
	"item_orb_of_venom";
	"item_platemail";
	"item_point_booster";
	"item_quarterstaff";
	"item_quelling_blade";
	"item_reaver";
	"item_refresher_shard";
	"item_ring_of_health";
	"item_ring_of_protection";
	"item_ring_of_regen";
	"item_robe";
	"item_relic";
	"item_sobi_mask";
	"item_ward_sentry";
	"item_shadow_amulet";
	"item_slippers";
	"item_smoke_of_deceit";
	"item_staff_of_wizardry";
	"item_stout_shield";
	"item_talisman_of_evasion";
	"item_tango";
	"item_tango_single";
	"item_tome_of_knowledge";
	"item_tpscroll";
	"item_ultimate_orb";
	"item_vitality_booster";
	"item_void_stone";
	"item_wind_lace"    
}

ItemModule["item_abyssal_blade"] = { "item_basher"; "item_vanguard"; "item_recipe_abyssal_blade" }

ItemModule["item_aether_lens"] = { "item_void_stone"; "item_energy_booster"; "item_recipe_aether_lens" }

ItemModule["item_ultimate_scepter"] = { "item_point_booster"; "item_ogre_axe"; "item_staff_of_wizardry"; "item_blade_of_alacrity" }

ItemModule["item_arcane_boots"] = { "item_boots"; "item_energy_booster"}

ItemModule["item_armlet"] = { "item_helm_of_iron_will"; "item_gloves"; "item_blades_of_attack"; "item_recipe_armlet" }

ItemModule["item_assault"] = { "item_platemail"; "item_hyperstone"; "item_chainmail"; "item_recipe_assault" }

ItemModule["item_bfury"] = { "item_quelling_blade"; "item_pers"; "item_demon_edge"; "item_recipe_bfury" }

ItemModule["item_black_king_bar"] = { "item_ogre_axe"; "item_mithril_hammer"; "item_recipe_black_king_bar" }

ItemModule["item_blade_mail"] = {  "item_chainmail"; "item_robe"; "item_broadsword" }

ItemModule["item_bloodstone"] = { "item_point_booster"; "item_vitality_booster"; "item_energy_booster"; "item_pers" }

ItemModule["item_bloodthorn"] = { "item_orchid"; "item_lesser_crit"; "item_recipe_bloodthorn" }

ItemModule["item_travel_boots"] = { "item_boots"; "item_recipe_travel_boots" }

ItemModule["item_travel_boots_2"] = { "item_travel_boots"; "item_recipe_travel_boots" }

ItemModule["item_bracer"] = { "item_gauntlets"; "item_circlet"; "item_recipe_bracer" }

ItemModule["item_buckler"] = { "item_branches"; "item_chainmail"; "item_recipe_buckler" }

ItemModule["item_butterfly"] = { "item_talisman_of_evasion"; "item_eagle"; "item_quarterstaff" }

ItemModule["item_crimson_guard"] = { "item_vanguard"; "item_buckler"; "item_recipe_crimson_guard" }

ItemModule["item_lesser_crit"] = { "item_broadsword"; "item_blades_of_attack"; "item_recipe_lesser_crit" }

ItemModule["item_greater_crit"] = { "item_lesser_crit"; "item_demon_edge"; "item_recipe_greater_crit" }

ItemModule["item_dagon"] = { "item_null_talisman"; "item_staff_of_wizardry"; "item_recipe_dagon" }

ItemModule["item_dagon_2"] = { "item_dagon"; "item_recipe_dagon" }

ItemModule["item_dagon_3"] = { "item_dagon_2"; "item_recipe_dagon" }

ItemModule["item_dagon_4"] = { "item_dagon_3"; "item_recipe_dagon" }

ItemModule["item_dagon_5"] = { "item_dagon_4"; "item_recipe_dagon" }

ItemModule["item_desolator"] = { "item_mithril_hammer"; "item_mithril_hammer"; "item_blight_stone" }

ItemModule["item_diffusal_blade"] = { "item_blade_of_alacrity"; "item_blade_of_alacrity"; "item_robe"; "item_recipe_diffusal_blade" }

ItemModule["item_diffusal_blade_2"] = { "item_diffusal_blade"; "item_recipe_diffusal_blade" }

ItemModule["item_dragon_lance"] = { "item_boots_of_elves"; "item_boots_of_elves"; "item_ogre_axe" }

ItemModule["item_ancient_janggo"] = { "item_bracer"; "item_wind_lace"; "item_sobi_mask"; "item_recipe_ancient_janggo" }

ItemModule["item_echo_sabre"] = { "item_oblivion_staff"; "item_ogre_axe" }

ItemModule["item_ethereal_blade"] = { "item_ghost"; "item_eagle" }

ItemModule["item_cyclone"] = { "item_wind_lace"; "item_void_stone"; "item_staff_of_wizardry"; "item_recipe_cyclone" }

ItemModule["item_skadi"] = { "item_point_booster"; "item_ultimate_orb"; "item_ultimate_orb" }

ItemModule["item_force_staff"] = { "item_staff_of_wizardry"; "item_ring_of_regen"; "item_recipe_force_staff" }

ItemModule["item_glimmer_cape"] = { "item_cloak"; "item_shadow_amulet" }

ItemModule["item_guardian_greaves"] = { "item_arcane_boots"; "item_mekansm"; "item_recipe_guardian_greaves" }

ItemModule["item_hand_of_midas"] = { "item_gloves"; "item_recipe_hand_of_midas" }

ItemModule["item_headdress"] = { "item_branches"; "item_ring_of_regen"; "item_recipe_headdress" }

ItemModule["item_heart"] = { "item_reaver"; "item_vitality_booster"; "item_vitality_booster" }

ItemModule["item_heavens_halberd"] = { "item_sange"; "item_talisman_of_evasion"}

ItemModule["item_helm_of_the_dominator"] = { "item_headdress"; "item_gloves"; "item_ring_of_health" }

ItemModule["item_hood_of_defiance"] = { "item_ring_of_health"; "item_cloak"; "item_ring_of_regen" }

ItemModule["item_hurricane_pike"] = { "item_dragon_lance"; "item_force_staff"; "item_wraith_band" }

ItemModule["item_iron_talon"] = { "item_quelling_blade"; "item_ring_of_protection"; "item_recipe_iron_talon" }

ItemModule["item_sphere"] = { "item_pers"; "item_ultimate_orb"; "item_recipe_sphere" }

ItemModule["item_lotus_orb"] = { "item_pers"; "item_platemail"; "item_energy_booster" }

ItemModule["item_maelstrom"] = { "item_javelin"; "item_mithril_hammer" }

ItemModule["item_magic_wand"] = { "item_branches"; "item_branches"; "item_magic_stick"; "item_recipe_magic_wand" }

ItemModule["item_manta"] = { "item_yasha"; "item_ultimate_orb"; "item_recipe_manta" }

ItemModule["item_mask_of_madness"] = { "item_lifesteal"; "item_quarterstaff" }

ItemModule["item_medallion_of_courage"] = { "item_chainmail"; "item_sobi_mask"; "item_blight_stone" }

ItemModule["item_mekansm"] = { "item_buckler"; "item_headdress"; "item_recipe_mekansm" }

ItemModule["item_mjollnir"] = { "item_maelstrom"; "item_hyperstone"; "item_recipe_mjollnir" }

ItemModule["item_monkey_king_bar"] = { "item_quarterstaff"; "item_javelin"; "item_demon_edge" }

ItemModule["item_moon_shard"] = { "item_hyperstone"; "item_hyperstone"}

ItemModule["item_necronomicon"] = { "item_sobi_mask"; "item_sobi_mask"; "item_belt_of_strength"; "item_recipe_necronomicon" }

ItemModule["item_necronomicon_2"] = { "item_necronomicon"; "item_recipe_necronomicon" }

ItemModule["item_necronomicon_3"] = { "item_necronomicon_2"; "item_recipe_necronomicon" }
	    
ItemModule["item_null_talisman"] = { "item_mantle"; "item_circlet"; "item_recipe_null_talisman" }

ItemModule["item_oblivion_staff"] = { "item_quarterstaff"; "item_robe"; "item_sobi_mask" }

ItemModule["item_octarine_core"] = { "item_soul_booster"; "item_mystic_staff" }

ItemModule["item_orchid"] = { "item_oblivion_staff"; "item_oblivion_staff"; "item_recipe_orchid" }

ItemModule["item_pers"] = { "item_ring_of_health"; "item_void_stone" }

ItemModule["item_phase_boots"] = { "item_boots"; "item_blades_of_attack"; "item_blades_of_attack" }

ItemModule["item_pipe"] = { "item_hood_of_defiance"; "item_headdress"; "item_recipe_pipe" }

ItemModule["item_poor_mans_shield"] = { "item_stout_shield"; "item_slippers"; "item_slippers" }

ItemModule["item_power_treads_agi"] = { "item_boots"; "item_boots_of_elves"; "item_gloves" }

ItemModule["item_power_treads_int"] = { "item_boots"; "item_robe"; "item_gloves" }

ItemModule["item_power_treads_str"] = { "item_boots"; "item_belt_of_strength"; "item_gloves" }

ItemModule["item_power_treads"] = { "item_boots"; "item_belt_of_strength"; "item_gloves" }

ItemModule["item_radiance"] = { "item_relic"; "item_recipe_radiance" }

ItemModule["item_rapier"] = { "item_relic"; "item_demon_edge" }

ItemModule["item_refresher"] = { "item_pers"; "item_pers"; "item_recipe_refresher" }
				
ItemModule["item_ring_of_aquila"] = { "item_ring_of_basilius"; "item_wraith_band" }
			    
ItemModule["item_ring_of_basilius"] = {  "item_ring_of_protection"; "item_sobi_mask" }
				
ItemModule["item_rod_of_atos"] = { "item_bracer"; "item_bracer"; "item_staff_of_wizardry"; "item_recipe_rod_of_atos" }

ItemModule["item_sange"] = { "item_belt_of_strength"; "item_ogre_axe"; "item_recipe_sange" }
			    
ItemModule["item_sange_and_yasha"] = { "item_yasha"; "item_sange" }

ItemModule["item_satanic"] = { "item_lifesteal"; "item_reaver"; "item_claymore" }

ItemModule["item_sheepstick"] = { "item_mystic_staff"; "item_ultimate_orb"; "item_void_stone" }

ItemModule["item_invis_sword"] = { "item_shadow_amulet"; "item_claymore" }

ItemModule["item_shivas_guard"] = { "item_platemail"; "item_mystic_staff"; "item_recipe_shivas_guard" }

ItemModule["item_silver_edge"] = { "item_invis_sword"; "item_ultimate_orb"; "item_recipe_silver_edge" }

ItemModule["item_basher"] = { "item_mithril_hammer"; "item_belt_of_strength"; "item_recipe_basher" }

ItemModule["item_solar_crest"] = { "item_medallion_of_courage"; "item_talisman_of_evasion" }

ItemModule["item_soul_booster"] = { "item_point_booster"; "item_vitality_booster"; "item_energy_booster" }

ItemModule["item_soul_ring"] = { "item_ring_of_regen"; "item_gauntlets"; "item_gauntlets"; "item_recipe_soul_ring" }

ItemModule["item_tranquil_boots"] = { "item_wind_lace"; "item_boots"; "item_ring_of_regen" }

ItemModule["item_urn_of_shadows"] = { "item_circlet"; "item_ring_of_protection"; "item_recipe_urn_of_shadows"; "item_infused_raindrop" }

ItemModule["item_vanguard"] = { "item_stout_shield" ; "item_vitality_booster"; "item_ring_of_health" }

ItemModule["item_veil_of_discord"] = { "item_null_talisman" ; "item_null_talisman"; "item_helm_of_iron_will"; "item_recipe_veil_of_discord" }

ItemModule["item_vladmir"] = { "item_ring_of_basilius" ; "item_lifesteal"; "item_headdress" }

ItemModule["item_wraith_band"] = { "item_slippers"; "item_circlet"; "item_recipe_wraith_band" }

ItemModule["item_yasha"] = { "item_boots_of_elves"; "item_blade_of_alacrity"; "item_recipe_yasha" }

---------- NEW ITEM BELOW ----------------
ItemModule["item_meteor_hammer"] = { "item_ring_of_regen"; "item_sobi_mask"; "item_ogre_axe"; "item_staff_of_wizardry" }
--aeon disk
ItemModule["item_aeon_disk"] = { "item_vitality_booster"; "item_energy_booster"; "item_recipe_aeon_disk" }

ItemModule["item_spirit_vessel"] = { "item_urn_of_shadows"; "item_wind_lace"; "item_vitality_booster"; "item_recipe_spirit_vessel" }

ItemModule["item_nullifier"] = { "item_helm_of_iron_will"; "item_relic" }
--kaya
ItemModule["item_kaya"] = { "item_robe"; "item_staff_of_wizardry"; "item_recipe_kaya" }


--Normalize some item names 
function ItemModule.NormItemName(item_name)
	if item_name == "item_power_treads_agi" or  item_name == "item_power_treads_str" or  item_name == "item_power_treads_int" then
		return 'item_power_treads';
	--[[elseif item_name == 'item_shadow_blade' then
		return 'item_invis_sword';
	elseif item_name == 'item_diffusal_blade_1' then
		return 'item_diffusal_blade';	
	elseif item_name == 'item_eye_of_skadi' then
		return 'item_skadi';]]--		
	end
	return item_name;
end

--Check if hero have the current itemToBuy in main inventory
function ItemModule.IsItemInHero(item_name)
	if item_name == 'item_infused_raindrop' then 
		return false; 
	else 
		local bot = GetBot();
		item_name = ItemModule.NormItemName(item_name);
		local slot = bot:FindItemSlot(item_name);
		local slotType = bot:GetItemSlotType(slot);
		return slotType == ITEM_SLOT_TYPE_MAIN or slotType == ITEM_SLOT_TYPE_BACKPACK;	
	end
end

--Get basic item recursively from ItemUtility data
function ItemModule.GetBasicItems( ... )
    local basicItemTable = {}
    for i,v in pairs(...) do
        if ItemModule[v] ~= nil and ItemModule.IsItemInHero(v) == false then
            for _,w in pairs(ItemModule.GetBasicItems(ItemModule[v])) do
				basicItemTable[#basicItemTable+1] = w;
            end
        elseif ItemModule[v] == nil and ItemModule.IsItemInHero(v) == false then
			basicItemTable[#basicItemTable+1] = v;
        end
    end
    return basicItemTable
end

function ItemModule.GetBasicItemsNew( ... )
    local basicItemTable = {}
    for i,v in pairs(...) do
		--print(tostring(v))
		local comps = GetItemComponents(v);
		--print(tostring(#comps))
        if #comps > 0 and ItemModule.IsItemInHero(v) == false then
            for _,w in pairs(ItemModule.GetBasicItems(comps[1])) do
				basicItemTable[#basicItemTable+1] = w;
            end
        elseif #comps == 0 and ItemModule.IsItemInHero(v) == false then
			basicItemTable[#basicItemTable+1] = v;
        end
    end
    return basicItemTable
end

function ItemModule.GetEmptyInventoryAmount(bot)
	local amount = 0;
	for i=0,8 do	
		local item = bot:GetItemInSlot(i);
		if item == nil then
			amount = amount + 1;
		end
	end
	return amount;
end

function ItemModule.RemoveItem(tTable, item_name)
	local temp = {};
	for i=1, #tTable do
		if tTable[i] ~= item_name then
			temp[#temp+1] = tTable[i];
		end
	end
	return temp;
end

function ItemModule.GetItemCharges(bot, item_name)
	local charges = 0;
	for i = 0, 15 do
		local item = bot:GetItemInSlot(i);
		if item ~= nil and item:GetName() == item_name then
			charges = charges + item:GetCurrentCharges();
		end
	end
	return charges;
end

function ItemModule.HasItem(bot, item_name)
	return bot:FindItemSlot(item_name) >= 0;
end

function ItemModule.UpdateBuyBootStatus(bot)
	local bootsSlot = bot:FindItemSlot('item_boots');
	if bootsSlot == - 1 then
		for i=1,#ItemModule['earlyBoots'] do
		    bootsSlot = bot:FindItemSlot(ItemModule['earlyBoots'][i]);
			if bootsSlot >= 0 then
				break;
			end
		end
	end
	return bootsSlot >= 0;
end

function ItemModule.GetMainInvLessValItemSlot(bot)
	local minPrice = 10000;
	local minSlot = -1;
	for i=0,5,1 do
		local item = bot:GetItemInSlot(i);
		if  item ~= nil and item:GetName() ~= "item_aegis" 
		    and item:GetName() ~= "item_refresher_shard" 
		    and item:GetName() ~= "item_cheese" 
		    and item:GetName() ~= "item_bloodstone" 
		then
			local cost = GetItemCost(item:GetName()); 
			if  cost < minPrice then
				minPrice = cost;
				minSlot = i;
			end
		end
	end
	return minSlot;
end

return ItemModule